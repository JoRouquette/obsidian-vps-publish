<mat-toolbar class="topbar mat-elevation-z2" role="banner">
  <!-- Mobile: burger menu button (left) -->
  <button
    mat-icon-button
    class="mobile-burger-btn"
    (click)="burgerMenuClick.emit()"
    aria-label="Ouvrir le menu"
  >
    <mat-icon>menu</mat-icon>
  </button>

  <!-- Ligne 1 : Contrôles principaux -->
  <a class="site-name" [routerLink]="'/'" aria-label="Accueil">
    {{ siteName || "Scribe d'Ektaron" }}
  </a>

  <app-search-bar
    class="desktop-search"
    placeholder="Rechercher titre, tag..."
    [value]="search.query()"
    (queryChange)="onQueryInput($event)"
  ></app-search-bar>

  <!-- Mobile: search icon button (right) -->
  <button
    mat-icon-button
    class="mobile-search-btn"
    (click)="searchIconClick.emit()"
    aria-label="Rechercher"
  >
    <mat-icon>search</mat-icon>
  </button>

  <div
    class="toolbar-actions"
    matTooltip="{{ isDark ? 'Activer le thème clair' : 'Activer le thème sombre' }}"
    matTooltipPosition="left"
  >
    <button
      mat-icon-button
      type="button"
      (click)="toggleTheme.emit()"
      [attr.aria-label]="isDark ? 'Activer le thème clair' : 'Activer le thème sombre'"
    >
      @if (!isDark) {
        <mat-icon>dark_mode</mat-icon>
      }
      @if (isDark) {
        <mat-icon>light_mode</mat-icon>
      }
    </button>
  </div>

  <!-- Ligne 2 : Breadcrumbs (fil d Ariane) -->
  <nav class="breadcrumbs" aria-label="Fil d Ariane" data-testid="breadcrumbs">
    @for (c of crumbs; track c.url; let last = $last) {
      <span class="crumb" aria-current="{{ last ? 'page' : undefined }}">
        <span [class.last]="last">{{ c.label }}</span>
      </span>
      @if (!last) {
        <mat-icon class="sep" aria-hidden="true">chevron_right</mat-icon>
      }
    }
  </nav>
</mat-toolbar>
