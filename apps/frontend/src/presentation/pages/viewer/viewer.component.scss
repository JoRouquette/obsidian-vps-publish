:host {
  display: block;
  inline-size: 100%;
  block-size: 100%;
  min-width: 0;
  min-height: 0;
}

.viewer {
  /* Aliases vers ITS (fallback mat-sys) */
  --c-surface: var(--its-surface, var(--mat-sys-surface));
  --c-on-surface: var(--its-on-surface, var(--mat-sys-on-surface));
  --c-surface-variant: var(--its-surface-variant, var(--mat-sys-surface-variant));
  --c-outline: var(--its-outline, var(--mat-sys-outline-variant));
  --c-primary: var(--its-primary, var(--mat-sys-primary));
  --c-secondary: var(--its-secondary, var(--mat-sys-secondary));
  --c-headers: var(--its-headers, var(--its-primary, var(--mat-sys-primary)));

  color: var(--c-on-surface);
  background: transparent;

  .title {
    margin: 0 0 0.75rem 0;
    line-height: 1.2;
    color: var(--c-headers);
    word-break: break-word;
  }

  .content {
    inline-size: 100%;
    max-inline-size: 100%;
    min-inline-size: 0;
    color: var(--c-on-surface);
    line-height: 1.6;
    overflow-wrap: anywhere;
    word-break: break-word;

    /* ================= SCOPE MARKDOWN ================= */
    > .markdown-body {
      /* 1) Masquer le header interne pour éviter le double H1 */
      > .page-header {
        display: none;
      }

      /* 1-bis) “Démoter” visuellement les H1 internes */
      h1 {
        /* Visuel proche d’un H2 */
        font-size: clamp(1.35rem, 1.9vw, 1.6rem);
        margin: 1.1rem 0 0.5rem;
        line-height: 1.25;
        color: var(--c-headers);
      }
      h2 {
        font-size: clamp(1.2rem, 1.6vw, 1.35rem);
        margin: 1rem 0 0.5rem;
        line-height: 1.25;
        color: var(--c-headers);
      }
      h3,
      h4,
      h5,
      h6 {
        font-size: 1rem;
        margin: 0.85rem 0 0.4rem;
        line-height: 1.25;
        color: var(--c-headers);
      }

      p {
        margin: 0.5rem 0 0.7rem;
      }

      ul,
      ol {
        padding-inline-start: 1.15rem;
        margin: 0.45rem 0 0.65rem;
      }

      /* 2) Pansement pour le bloc "front-matter" rendu dans le corps
         -> on l'atténue visuellement si présent après le tout début */
      > hr:first-child {
        /* si ta chaîne met un <hr> juste après l’entête, on l’allège */
        border: 0;
        border-top: 1px solid color-mix(in oklab, var(--c-outline) 35%, transparent);
        margin: 0.4rem 0;
        opacity: 0.6;
      }
      /* Si l’export place des <p> "tags:" / "aliases:" juste après:
         on les grise légèrement pour ne plus parasiter la lecture. */
      > hr:first-child + p,
      > hr:first-child + p + ul {
        color: color-mix(in oklab, var(--c-on-surface) 65%, transparent);
        font-size: 0.92em;
        line-height: 1.35;
        margin: 0.25rem 0 0.4rem;
      }

      a {
        color: var(--c-secondary);
        text-decoration: underline;
        text-underline-offset: 2px;
      }

      /* Inline code très discret */
      code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace;
        background: color-mix(in oklab, var(--c-surface-variant) 12%, transparent);
        padding: 0.08em 0.35em;
        border-radius: 6px;
      }

      /* Blocs code sobres */
      pre {
        margin: 0.9rem 0;
        padding: 0.7rem 0.9rem;
        background: color-mix(in oklab, var(--c-surface-variant) 16%, transparent);
        border: 1px solid color-mix(in oklab, var(--c-outline) 40%, transparent);
        border-radius: 10px;
        overflow: auto;
        max-inline-size: 100%;
      }
      pre > code {
        background: transparent;
        padding: 0;
      }

      /* Citations: filet + fond à peine teinté */
      blockquote {
        margin: 0.9rem 0;
        padding: 0.45rem 0.9rem;
        border-inline-start: 4px solid var(--c-secondary);
        background: color-mix(in oklab, var(--c-surface-variant) 10%, transparent);
        border-radius: 8px;
      }

      /* Séparateur discret */
      hr {
        border: 0;
        border-top: 1px solid color-mix(in oklab, var(--c-outline) 40%, transparent);
        margin: 0.9rem 0;
      }

      /* Tables scrollables, bord fin */
      table {
        border-collapse: collapse;
        width: 100%;
        max-inline-size: 100%;
        display: block;
        overflow-x: auto;
        border: 1px solid color-mix(in oklab, var(--c-outline) 40%, transparent);
        border-radius: 10px;
      }
      thead {
        background: color-mix(in oklab, var(--c-surface-variant) 14%, transparent);
      }
      th,
      td {
        padding: 0.45rem 0.7rem;
        border-bottom: 1px solid color-mix(in oklab, var(--c-outline) 32%, transparent);
        vertical-align: top;
      }
      tr:last-child td {
        border-bottom: 0;
      }

      /* Médias */
      img,
      video,
      svg,
      canvas {
        display: block;
        max-inline-size: 100%;
        height: auto;
      }
      iframe {
        display: block;
        width: 100%;
        max-inline-size: 100%;
        border: 0;
        aspect-ratio: 16 / 9;
      }
    }
  }

  @media (max-width: 600px) {
    .content > .markdown-body {
      line-height: 1.55;
      pre {
        padding: 0.6rem 0.75rem;
      }
      th,
      td {
        padding: 0.4rem 0.55rem;
      }
    }
  }
}
